/**
 * Типы данных для таймлайна.
 * Содержит описание структуры блока (BlockExt) и исполнителя (Executor),
 * которые используются для отображения и управления этапами в редакторе ППР.
 */

import type { StageField } from '@/entities/template/model/store/templateStore';

/**
 * Описание блока (этапа) на таймлайне.
 * Блок соответствует одному этапу выполнения задачи и содержит
 * временные границы, связь с шаблоном и источником.
 */
export interface BlockExt {
  /** Уникальный идентификатор блока */
  id: number;

  /** Отображаемая подпись блока */
  label: string;

  /** Время начала этапа (строка в формате HH:MM) */
  startTime: string;

  /** Время окончания этапа (строка в формате HH:MM) */
  endTime: string;

  /** Индекс шаблона (tplIdx), определяющий порядок блоков */
  tplIdx: number;

  /** Массив ключей этапов, которые входят в этот блок */
  stageKeys: string[];

  /** Объект полей этапов, сопоставленных с их ключами */
  stagesField: Record<string, StageField>;

  /** Нормализованный ключ источника записи из таблицы */
  sourceKey?: string;
}

/**
 * Описание исполнителя (строки на таймлайне).
 * Каждая строка соответствует исполнителю
 * выполняющего один или несколько блоков (этапов).
 */
export interface Executor {
  /** Уникальный идентификатор исполнителя (rowId, хеш или явный ID) */
  id: number;

  /** Автор / ФИО / логин исполнителя */
  author: string;

  /** Роль исполнителя ( Сетевой инженер, Представитель заказчика, СМР) */
  role: string;

  /** Массив блоков (этапов), назначенных этому исполнителю */
  blocks?: BlockExt[];

  /** Флаг дополнительной строки исполнителя (режим «+») */
  isExtra?: boolean;

  /** Ссылка на идентификатор родительского исполнителя (для дополнительных строк) */
  parentId?: number;
}
